{"version":3,"sources":["../../src/middleware/security.js"],"names":["securityMiddleware","req","res","next","permitted","locals","AccessDeniedError"],"mappings":";;;;;;AAAA;;;;;;AAEA,IAAMA,qBAAqB,SAArBA,kBAAqB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAAA,QACnCC,SADmC,GACrBF,IAAIG,MADiB,CACnCD,SADmC;;AAE3C,QAAI,CAACA,SAAL,EAAgB,MAAM,IAAIE,sBAAJ,EAAN;AAChBH;AACH,CAJD;;kBAMeH,kB","file":"security.js","sourcesContent":["import AccessDeniedError from \"../error/accessDenied\";\r\n\r\nconst securityMiddleware = (req, res, next) => {\r\n    const { permitted } = res.locals;\r\n    if (!permitted) throw new AccessDeniedError;\r\n    next();\r\n};\r\n\r\nexport default securityMiddleware;"]}